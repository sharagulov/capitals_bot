generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model Country {
  id         Int      @id @default(autoincrement())
  name       String
  addName    String?
  capital    String
  addCapital String?
  region     String
  addedBy    String?
  flag       String?
  createdAt  DateTime @default(now())

  stats SessionStat[]
}

model User {
  id              Int      @id @default(autoincrement())
  username        String
  shortName       String?
  telegramId      BigInt   @unique
  isAdmin         Boolean  @default(false)
  createdAt       DateTime @default(now())
  poolSize        Int      @default(20)
  gameMode        String   @default("Угадай столицу")
  preferredRegion String   @default("Все")
  questionsMode   Boolean  @default(false)
  hardMode        Boolean  @default(false)

  stats SessionStat[]
}

model SessionStat {
  id        Int      @id @default(autoincrement())
  user      User     @relation(fields: [userId], references: [id])
  userId    Int
  country   Country  @relation(fields: [countryId], references: [id])
  countryId Int
  isCorrect Boolean
  direction String
  timestamp DateTime @default(now())

  @@index([userId, timestamp])
  @@index([countryId, timestamp])
  @@index([userId, countryId])
}
